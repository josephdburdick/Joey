export let logoDefaults = {
  giphyAPIkey: "dc6zaTOxFJmzC",
  backup: "data:image/png;base64,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",
  search: "perfect loop",
  limit: 5,
  size: "fixed_height",
  interval: 5000
};

export function createLogoRequest(query){
  const {
    giphyAPIkey,
    search,
    limit,
    size,
    interval
  } = Object.assign({}, logoDefaults, query);
  const searchString = search.split(' ').join('+');
  return `https://api.giphy.com/v1/gifs/search?q=${searchString}?limit=${limit}&api_key=${giphyAPIkey}`;
}

export function requestLogoImage(request){
  return fetch(request)
    .then(response => response.json())
    .then(json => json)
    .catch(error => error.message);
}

export function getLogoState({gifs, size, interval, limit}){
  const count = gifs.length;
  let logoTimer;
  const promise = new Promise((resolve, reject) => {
    this.setState({logo: {
      width: 2,
      height: 2,
      url: logoDefaults.backup
    }});

    if (!interval){
      const randomIndex = Math.floor(Math.random() * count);
      const {width, height, url} = gifs[randomIndex].images[size];
      resolve({
        width,
        height,
        url
      });
    } else {
      /* Instead of looping through all results, use a limit on an array of random numbers */
      let randomImageIndexArray = []
      while (randomImageIndexArray.length < limit) {
        const randomNumber = Math.ceil(Math.random() * count)
        let found = false;
        for (var i = 0; i < randomImageIndexArray.length; i++) {
          if (randomImageIndexArray[i] == randomNumber) {
            found = true;
            break;
          }
        }
        if (!found)
          randomImageIndexArray[randomImageIndexArray.length] = randomNumber;
      }
      setInterval(() => {
        /* Generate an array of [this.props.limit] number of items */
        const randomIndex = Math.floor(Math.random() * randomImageIndexArray.length );
        resolve({
          width: gifs[randomIndex].images[size].width,
          height: gifs[randomIndex].images[size].height,
          url: gifs[randomIndex].images[size].url
        });
      }, interval);
    }
  });
  return promise;
}
